//https://www.w3schools.com/js/js_json.asp
//This dictionary was generated programmatically with Python
var graphemes = {' ': ' ',
    '0': '‚Üò',
    '1': 'À©',
    '2': 'À®',
    '3': 'Àß',
    '4': 'À¶',
    '5': 'À•',
    '6': '‚Üì',
    '7': '‚Üë',
    '9': '‚Üó',
    'A': '…ë',
    'A)': '…í',
    'E': '…õ',
    'E"': '…ú',
    'E)': '≈ì',
    'I': '…™',
    'I"': '…ò',
    'O': '…î',
    'O"': '…û',
    'O(': ' å',
    'U': ' ä',
    'Y': ' è',
    '@': '√¶',
    '*': '*',
    '*+': '\\\\',
    '*-': 'Õç',
    '*%': 'Ãë',
    '*_': 'Õ¢',
    '*=': 'Ãª',
    '*H': '‚Åº',
    '*W': ' ¨',
    '*M': '\uf07d',
    '*G': '\uf005',
    '*K': '\uf004',
    '*P': '¬°',
    '*>': 'Õî',
    '*<': 'Õï',
    '*R': '‚ÜÄ',
    '*"': 'Õà',
    '*.': 'Õâ',
    '*)': '‚Çé',
    '*(': '‚Çç',
    '*B': ' ±',
    '*C': 'Ã∞',
    '*N': '\uf006',
    '*D': 'Õä',
    '*L': '\uf07c',
    '*V': '‚Üì',
    '*|': 'Õé',
    '*X': '\uf003',
    '*F': ' ©',
    '*~': 'Õå',
    '*T': ' ≠',
    '*S': 'Íûé',
    '*Z': '\uf035',
    '?': ' î',
    '?;': ' ¢',
    '?+': ' °',
    '?H': ' ï', "'": ' º', "'+": 'Àñ', "'-": '‚Åª', "'%": 'Ãë', "';": 'Àï', "',": 'Ãç', "'_": 'ÀΩ', "'H": ' ∞', "'W": ' ∑', "'M": 'Ãº', "'J": ' ≤', "'G": 'À†', "'P": 'À§', "'!": '·∑µ', "'>": 'Í≠™', "'<": 'Í≠´', "'R": 'Àû',
    '\'"': 'Ãà', "'`": 'Ãö', "')": 'Õó', "'(": 'Õë', "'B": ' ±', "'C": 'Ã∞', "'N": '‚Åø', "'D": 'ÕÜ', "'=": 'Ãª', "'L": 'À°', "'|": 'Ã¥', "'X": 'ÃΩ', "'F": 'Ãä', "'V": 'Ãå', "'~": 'ÃÉ',
    '^': '^',
    '^+': 'Àñ',
    '^-': 'Àó',
    '^%': '·µî',
    '^;': 'Àï',
    '^,': 'Àà',
    '^_': 'ÀΩ',
    '^H': ' ∞',
    '^W': ' ∑',
    '^M': 'Ãº',
    '^J': ' ≤',
    '^G': 'À†',
    '^P': 'À§',
    '^!': 'Àî',
    '^>': 'Í≠™',
    '^<': 'Í≠´',
    '^R': 'Àû',
    '^"': '¬®',
    '^`': 'À∫',
    '^)': 'Àí',
    '^(': 'Àì',
    '^B': ' ±',
    '^C': 'Ã∞',
    '^N': '‚Åø',
    '^D': 'Ã™',
    '^=': '‚ñ´',
    '^L': 'À°',
    '^|': 'Ã¥',
    '^X': 'À£',
    '^F': 'À≥',
    '^V': 'À¨',
    '^~': 'Àú',
    '/': '/',
    '/+': 'Ãü',
    '/-': 'Ã†',
    '/%': 'ÃØ',
    '/;': 'Ãû',
    '/,': 'Ã©',
    '/_': 'Ã∫',
    '/H': '‚Çï',
    '/W': ' ∑',
    '/M': 'Ãº',
    '/J': '‚±º',
    '/G': '·µß',
    '/P': '‚Çö',
    '/!': 'Ãù',
    '/>': 'Ãò',
    '/<': 'Ãô',
    '/R': 'Àû',
    '/"': 'Ã§',
    '/`': 'Õâ',
    '/)': 'Ãπ',
    '/(': 'Ãú',
    '/B': 'Ã§',
    '/C': 'Ã∞',
    '/N': '‚Çô',
    '/D': 'Ã™',
    '/=': 'Ãª',
    '/L': '‚Çó',
    '/|': 'Ã¥',
    '/X': '‚Çì',
    '/F': 'Ã•',
    '/V': 'Ã¨',
    '/~': 'Ã∞',
    '.': '.',
    '.+': 'Àê',
    '.-': 'Àë',
    '.%': 'ÃÜ', ".'": 'Àà',
    '.,': 'Àå',
    '.:': '‚Äñ',
    '.|': '|',
    '._': 'Õú',
    '.=': 'Õ°',
    '.(': '‚ÅÄ',
    '.)': '‚Äø',
    '\\ ': ' ',
    '\\!': '!',
    '\\"': '"',
    '\\#': '#',
    '\\$': '$',
    '\\%': '%',
    '\\&': '&', "\\'": "\\'", '\\(': '(',
    '\\)': ')',
    '\\*': '*',
    '\\+': '+',
    '\\,': ',',
    '\\-': '-',
    '\\.': '.',
    '\\/': '/',
    '\\0': '0',
    '\\1': '1',
    '\\2': '2',
    '\\3': '3',
    '\\4': '4',
    '\\5': '5',
    '\\6': '6',
    '\\7': '7',
    '\\8': '8',
    '\\9': '9',
    '\\:': ':',
    '\\;': ';',
    '\\<': '<',
    '\\=': '=',
    '\\>': '>',
    '\\?': '?',
    '\\@': '@',
    '\\A': 'A',
    '\\B': 'B',
    '\\C': 'C',
    '\\D': 'D',
    '\\E': 'E',
    '\\F': 'F',
    '\\G': 'G',
    '\\H': 'H',
    '\\I': 'I',
    '\\J': 'J',
    '\\K': 'K',
    '\\L': 'L',
    '\\M': 'M',
    '\\N': 'N',
    '\\O': 'O',
    '\\P': 'P',
    '\\Q': 'Q',
    '\\R': 'R',
    '\\S': 'S',
    '\\T': 'T',
    '\\U': 'U',
    '\\V': 'V',
    '\\W': 'W',
    '\\X': 'X',
    '\\Y': 'Y',
    '\\Z': 'Z',
    '\\[': '[',
    '\\\\': '\\\\',
    '\\]': ']',
    '\\^': '^',
    '\\_': '_',
    '\\`': '`',
    '\\a': 'a',
    '\\b': 'b',
    '\\c': 'c',
    '\\d': 'd',
    '\\e': 'e',
    '\\f': 'f',
    '\\g': 'g',
    '\\h': 'h',
    '\\i': 'i',
    '\\j': 'j',
    '\\k': 'k',
    '\\l': 'l',
    '\\m': 'm',
    '\\n': 'n',
    '\\o': 'o',
    '\\p': 'p',
    '\\q': 'q',
    '\\r': 'r',
    '\\s': 's',
    '\\t': 't',
    '\\u': 'u',
    '\\v': 'v',
    '\\w': 'w',
    '\\x': 'x',
    '\\y': 'y',
    '\\z': 'z',
    '\\{': '{',
    '\\|': '|',
    '\\}': '}',
    '\\~': '~',
    'a': 'a',
    'a"': '…ê',
    'a)': '…∂',
    'b': 'b',
    'b<': '…ì',
    'b!': ' ò',
    'bB': ' ô',
    'bH': 'Œ≤',
    'c': 'c',
    'c<': ' Ñ',
    'c!': '«Ç',
    'cH': '√ß',
    'cL': 'ùºÜ',
    'd': 'd',
    'd<': '…ó',
    'd!': '«Ä',
    'd-': '…ñ',
    'dH': '√∞',
    'e': 'e',
    'e"': '…ô',
    'e)': '√∏',
    'f': 'f',
    'g': 'g',
    'g<': '…†',
    'g-': '…¢',
    'gH': '…£',
    'gQ': '\uf001',
    'gJ': '…ü',
    'gL': ' ü',
    'h': 'h',
    'h"': '…¶',
    'hH': ' ú',
    'h+': 'ƒß',
    'i': 'i',
    'i"': '…®',
    'j': 'j',
    'jW': '…•',
    'jL': ' é',
    'jH': ' ù',
    'k': 'k',
    'l': 'l',
    'l-': '…≠',
    'l`': '…∫',
    'l!': '«Å',
    'lS': ' ™',
    'lZ': ' ´',
    'm': 'm',
    'm-': '…±',
    'n': 'n',
    'n-': '…≥',
    'nJ': '…≤',
    'nG': '≈ã',
    'nQ': '…¥',
    'o': 'o',
    'o"': '…µ',
    'o(': '…§',
    'p': 'p',
    'pH': '…∏',
    'q': 'q',
    'q<': ' õ',
    'qR': ' Ä',
    'qQ': '\uf000',
    'r': 'r',
    'r-': '…ª',
    'rT': '…Ω',
    'r"': '…π',
    'r|': 'ùºä',
    'rH': ' Å',
    'r`': '…æ',
    'r!': '‚Äº',
    's': 's',
    's-': ' Ç',
    'sJ': '…ï',
    'sL': '…¨',
    'sH': ' É',
    't': 't',
    't!': '«É',
    't-': ' à',
    'tH': 'Œ∏',
    'u': 'u',
    'u"': ' â',
    'u(': '…Ø',
    'v': 'v',
    'vW': ' ã',
    'v`': '‚±±',
    'w': 'w',
    'w(': '…∞',
    'x': 'x',
    'x-': 'œá',
    'xW': ' ç',
    'xH': '…ß',
    'xL': '\uf268',
    'y': 'y',
    'z': 'z',
    'zJ': ' ë',
    'zL': '…Æ',
    'z-': ' ê',
    'zH': ' í'};

//https://www.w3schools.com/js/js_functions.asp
function parse(string){
    //https://www.w3schools.com/js/js_if_else.asp
    //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/length
    if (string.length == 0){
        return string;
    }
        
    var output = "";
    var last_digraph = false;
    var i = 0;
    //https://www.w3schools.com/js/js_loop_while.asp
    while (i < string.length - 1) {
        //https://www.w3schools.com/jsref/jsref_substring.asp
        //https://sentry.io/answers/difference-between-let-and-var-in-javascript/
        let substr = string.substring(i,i+2);
        let digraph_result = graphemes[substr];
        
        //https://stackoverflow.com/questions/19317943/why-referencing-non-existent-property-of-an-object-in-javascript-doesnt-return
        if (digraph_result != null) {
            last_digraph = true;
            output += digraph_result;
            i += 2;
        } else {
            last_digraph = false;
            let substr = string.substring(i, i+1);
            let monograph_result = graphemes[substr];
            if (monograph_result != null) {
                output += monograph_result;
                i += 1;
            }else {
                //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals
                return `There was an error at character ${i}`;
            }
        }
    }
    if (i == string.length - 1) {
        let substr = string.substring(string.length - 1, string.length);
        let monograph_result = graphemes[substr];
        if (monograph_result != null) {
            output += monograph_result;
        } else{
            if (last_digraph == false) {
                return `There was an error at character ${i}`;
            }
        }
    }

    return output;
}

function input_to_output() {
    var converter_form = document.getElementById("ascii_converter");
    //https://developer.mozilla.org/en-US/docs/Web/API/FormData/get
    var form_data = new FormData(converter_form);

    var output = parse(form_data.get("tipo_input"));

    var wrapper = form_data.get("wrapper");

    if (wrapper == "apostrophes") {
        output = "'" + output + "'";
    } else if (wrapper == "quotes") {
        output = '"' + output + '"';
    } else if (wrapper == "slashes") {
        output = '/' + output + '/';
    } else if (wrapper == "brackets") {
        output = '[' + output + ']';
    }

    //https://stackoverflow.com/questions/52097840/how-to-overwrite-text-in-p-tag-using-javascript
    document.getElementById("converter_output").innerText = output;

    //https://www.w3schools.com/howto/howto_js_copy_clipboard.asp
    if (form_data.get("copy") == "yes") {
        navigator.clipboard.writeText(output);
    }

    //https://stackoverflow.com/questions/64619241/how-do-you-change-a-html-text-after-form-submission
    return false;
}